/*! mellon 2016-10-07 */
$("document").ready(function(){$("#notes-list")&&getNotes(),$("#login-block")&&$("#login-block .form-submit").on("click",function(a){a.preventDefault(),$("#login-block .form-error").hide(),user=$("#user").val(),passphrase=$("#passphrase").val(),valid=!1,user&&passphrase&&(valid=!0),valid?$("#login-block form").submit():$("#login-block .form-error").show()})}),$("#notes-list").on("click","li>a",function(){noteId=$(this).parent().attr("id").split("-")[1],$.get("note/"+noteId,function(a){a.error?console.log("error : "+error):($("#note-container #note-id").val(a._id),$("#note-container #title").val(a.title),$("#note-container #content").val(a.content),$("#note-preview-container h1").html(a.title),$("#note-preview-container p").html(marked(a.content)),$("#note-container").hide(),$("#note-preview-container").show())})}).on("click","li>span.remove",function(){noteId=$(this).parent().attr("id").split("-")[1],$.ajax("note",{method:"DELETE",data:{_id:noteId}}).done(function(a){a.error?console.log("error : "+error):($("#note-container #note-id").val(""),$("#note-container #title").val(""),$("#note-container #content").val(""),$("#note-preview-container h1").html(""),$("#note-preview-container p").html(""),$("#note-container").show(),$("#note-preview-container").hide(),getNotes())})}).on("mouseover","li",function(){$(this).find(".remove").show()}).on("mouseout","li",function(){$(this).find(".remove").hide()}).on("click","a#new-note",function(){$("#note-container #note-id").val(""),$("#note-container #title").val(""),$("#note-container #content").val(""),$("#note-preview-container h1").html(""),$("#note-preview-container p").html(""),$("#note-container").show(),$("#note-preview-container").hide()}),$("#note-preview-container").on("click",function(){$("#note-preview-container").hide(),$("#note-container").show(),$("#note-container #content").focus()}),$("#note-container button").on("click",function(){method="PUT",noteId="",$("#note-container #note-id").val()&&(noteId=$("#note-container #note-id").val(),method="POST"),title=$("#note-container #title").val(),content=$("#note-container #content").val(),title&&content&&$.ajax("note",{method:method,data:{_id:noteId,title:title,content:content}}).done(function(a){a.error?console.log("error : "+error):($("#note-container #note-id").val(a._id),$("#note-container #title").val(a.title),$("#note-container #content").val(a.content),$("#note-preview-container h1").html(a.title),$("#note-preview-container p").html(marked(a.content)),$("#note-preview-container").show(),$("#note-container").hide(),getNotes())})}),getNotes=function(){$.get("notes",function(a){a.error?console.log("error : "+error):a.length>0&&($("#notes-list ul").html(""),$.each(a,function(a,b){subContent=b.content.substring(0,40),$("#notes-list ul").append('<li id="note-'+b._id+'"><span class="pull-right remove glyphicon glyphicon-remove-circle"></span><a href="#">'+b.title+'</a><br /><span class="preview">'+subContent+"</span></li>")}))})};